# 本书概述

1. 计算机系统漫游
2. 信息的表示和处理
3. 程序的机器级表示
4. 处理器体系结构
5. 优化性能程序
6. 存储器层次结构
7. 链接
8. 异常控制流
9. 虚拟内存
10. 系统级i/o
11. 网络编程
12. 并发编程

<h1>第一章 计算机系统漫游</h1>

## 1.1	信息就是位+上下文

系统中所有的信息——包括磁盘文件、内存中的程序、内存中存放的用户数据以及以及网络上传送的数据，都是由**一串比特**表示的

区分不同数据对象的唯一方法是我们读到这些数据对象的**上下文**

## 1.2	程序被其他程序翻译成不同的格式

编译系统由**预处理器（cpp）、编译器（cll）、汇编器（as）、连接器（ld）**构成

* 预处理阶段
  * 根据#开头的命令修改原始的C程序，得到另一个.i文件

* 编译阶段
  * 把.i翻译成一个包含汇编语言的程序.s	*汇编语言为不同的高级语言的不同的编译器提供了通用的输出语言*

* 汇编阶段
  * 将.s翻译成机器语言指令，打包成<u>可重定位目标程序</u>存到.o	*文本打开会出现乱码*

* 链接阶段
  * 输出会调用printf函数，这个函数位于printf.o的预编译好的目标文件中，他需要以某种方式合并到.o中，连接器就是干这个的，得到最后的可执行目标文件，能被加载到内存中，由系统执行

### 1.3 了解编译系统如何工作是大有益处的

* 优化程序性能
* 理解连接时出现的错误
* 避免安全漏洞

### 1.4处理器读并解释储存在内存中的指令

可执行的目标文件hello被存放在磁盘上，想要在unix系统上运行就把他输入到shell中

shell是一个**命令行解释器**，输出一个提示符，等待命令执行命令，如果第一个单词不是内置shell指令，那就把它当成可执行文件加载并运行等待终止，输出提示符等待命令

#### 1.4.1系统的硬件组成

1. 总线

   贯穿整个系统的电子管道，携带信息在各个部件之间传递通常被设计为指定字节快	*4个字节32位，8个字节64位*

2. I/O设备

   输入输出设备是系统与外部世界的联系渠道，例：输入：鼠标，键盘	输出：屏幕，磁盘

   每个设备都通过一个控制器或适配器与i/o总线相连	*控制器：主板上的芯片组适配器：主板上插的卡。二者功能都是在I/O总线和I/O设备之间传递信息*

![QQ图片20200305201318](D:\00000\computer system\picture\QQ图片20200305201318.png)

3. 主存

   临时储存设备，在处理器执行程序时，用来存放程序和程序处理时的数据

   物理上：由一组动态随机存取存储器（DRAM）组成

   逻辑上：线性的字节数组，每个字节都有唯一的地址，从0开始

4. 处理器

   中央处理单元（CPU），是解释（执行）主存中指令的引擎

   核心：1个大小为1个字的存储设备（或寄存器）称为程序计数器（PC），无论何时PC都指向主存中的某条机器语言指令（含有该条指令的地址）

   从通电到断电，CPU一直在执行PC指向的指令，在更新PC，这个模型由指令集架构决定的，在此模型中指令严格按照顺序执行，一条指令包含一系列步骤

   围绕主存，寄存器文件，算数/逻辑单元执行

   寄存器文件是一个小的存储设备由一些单个字长的寄存器组成，每个名字寄存器都是唯一个

   ALU计算新的数据和地址值

   CPU在指令下可能会进行如下操作

   * 加载

     从主存复制一个字节或字，覆盖寄存器

   * 存储

     从寄存器复制一个字节或字，覆盖主存

   * 操作

     把两个寄存器复制到ALU，ALU运算之后覆盖寄存器

   * 跳转

     从指令中拿1个字覆盖PC

#### 1.4.2运行hello程序

shell将字符逐一读入寄存器，在放到内存之中

![QQ图片20200305203245](D:\00000\computer system\picture\QQ图片20200305203245.png)

shell执行指令来加载，指令将目标文件中的代码和数据从磁盘复制到主存

利用直接存储器存储（DMA）技术，数据可以不通过处理器直接到主存

![](D:\00000\computer system\picture\QQ图片20200305203519.png)

被加载到主存之后，处理器开始执行main中的机器语言指令，将字符串中的字节从主存复制到寄存器文件，在从寄存器文件复制到显示设备

![](D:\00000\computer system\picture\QQ图片20200305203724.png)

### 1.5高速缓存至关重要

问题：系统花费了大量的时间把信息从一个地方转移到另一个地方

系统设计者主要目标：让这些复制操作尽可能快的完成

机械原理：较大的存储设备要比娇小的存储设备运行的慢，而快速设备的造价远高于同类低速设备

针对处理器和主存之间的差异，系统设计者用高速缓存存储器（cache）存放处理器近期可能会用到的信息

高速缓存用静态随机访问存储器（SRAM）的硬件技术实现，让系统获得一个大访问快的存储器

![](D:\00000\computer system\picture\QQ图片20200305204449.png)

利用高速缓存存储器能让程序的性能提高一个数量级